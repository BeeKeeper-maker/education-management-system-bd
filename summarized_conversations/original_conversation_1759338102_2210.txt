{'role': 'assistant', 'content': '<function_calls>\n<create-file file_path="server/src/db/schema/attendance.ts">\nimport { pgTable, text, timestamp, uuid, varchar, date } from \'drizzle-orm/pg-core\';\nimport { users } from \'./users\';\nimport { classes, sections } from \'./academic\';\n\nexport const attendance = pgTable(\'attendance\', {\n  id: uuid(\'id\').defaultRandom().primaryKey(),\n  userId: uuid(\'user_id\').references(() => users.id).notNull(),\n  date: date(\'date\').notNull(),\n  status: varchar(\'status\', { length: 20 }).notNull(), // present, absent, late, half_day, leave\n  checkInTime: varchar(\'check_in_time\', { length: 10 }), // HH:MM format\n  checkOutTime: varchar(\'check_out_time\', { length: 10 }),\n  remarks: text(\'remarks\'),\n  markedBy: uuid(\'marked_by\').references(() => users.id),\n  createdAt: timestamp(\'created_at\').defaultNow().notNull(),\n  updatedAt: timestamp(\'updated_at\').defaultNow().notNull(),\n});\n\nexport const classAttendance = pgTable(\'class_attendance\', {\n  id: uuid(\'id\').defaultRandom().primaryKey(),\n  classId: uuid(\'class_id\').references(() => classes.id).notNull(),\n  sectionId: uuid(\'section_id\').references(() => sections.id).notNull(),\n  date: date(\'date\').notNull(),\n  period: varchar(\'period\', { length: 50 }),\n  markedBy: uuid(\'marked_by\').references(() => users.id).notNull(),\n  createdAt: timestamp(\'created_at\').defaultNow().notNull(),\n});\n\nexport const leaveApplications = pgTable(\'leave_applications\', {\n  id: uuid(\'id\').defaultRandom().primaryKey(),\n  userId: uuid(\'user_id\').references(() => users.id).notNull(),\n  leaveType: varchar(\'leave_type\', { length: 50 }).notNull(), // sick, casual, emergency, other\n  startDate: date(\'start_date\').notNull(),\n  endDate: date(\'end_date\').notNull(),\n  reason: text(\'reason\').notNull(),\n  status: varchar(\'status\', { length: 20 }).default(\'pending\').notNull(), // pending, approved, rejected\n  approvedBy: uuid(\'approved_by\').references(() => users.id),\n  approvalDate: timestamp(\'approval_date\'),\n  remarks: text(\'remarks\'),\n  createdAt: timestamp(\'created_at\').defaultNow().notNull(),\n  updatedAt: timestamp(\'updated_at\').defaultNow().notNull(),\n});\n\nexport type Attendance = typeof attendance.$inferSelect;\nexport type ClassAttendance = typeof classAttendance.$inferSelect;\nexport type LeaveApplication = typeof leaveApplications.$inferSelect;\n</create-file>\n</function_calls>'}